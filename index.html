<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Hola React!</title>
    <link rel="stylesheet" href="estilo.css" />

    <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>

  <body>
    <!-- En este div mostraremos contenido-->
    <div id="contenido"></div>

    <script type="text/babel">
      // Tenemos un listado de películas
      const peliculas = [
        { id: 1, titulo: "Back to the Future", genero: "scifi" },
        { id: 2, titulo: "Top Gun", genero: "accion" },
        { id: 3, titulo: "Star Wars", genero: "scifi" },
        { id: 4, titulo: "Revenge of the Nerds", genero: "comedia" },
        { id: 5, titulo: "Police Academy", genero: "comedia" },
        { id: 6, titulo: "Avatar", genero: "scifi" },
      ];

      // Aqui debemos determinar lo que vamos a mostrar dentro de "contenido"
      // Deben listarse las películas, con un color de texto diferente para cada género
      // Además debemos mostrar un poster al azar de la lista de peliculas.
      // Al ser al azar, el poster podrá cambiar cada vez que refrescamos la página.

      function getRandomNumber(min, max) {
        return Math.floor(Math.random() * (max - min + 1) + min);
      }
      const randomNumber = getRandomNumber(1, peliculas.length);

      const getTitle = peliculas.filter((peli) => peli.id === randomNumber);

      const Poster = () => {
        const [poster, setPoster] = React.useState("");
        const getPoster = async () => {
          const posterUrl = await fetch(
            "https://www.omdbapi.com/?apikey=cc725204&t=" + getTitle[0].titulo
          )
            .then((res) => res.json())
            .then((data) => {
              setPoster(data.Poster);
            });
        };
        React.useEffect(() => {
          getPoster();
        }, []);

        return <img src={poster} alt="" />;
      };

      const elementoPelis = (
        <div>
          <Poster />
          {peliculas.map((peli) => (
            <div key={peli.id} className="card">
              <h2 className={peli.genero}>{peli.titulo}</h2>
            </div>
          ))}
        </div>
      );
      // Luego definimos el root para renderizar allí contenido
      const root = ReactDOM.createRoot(document.getElementById("contenido"));
      // Renderizamos con la siguiente sentencia (habría que definir antes qué tiene "elementoPelis")
      root.render(elementoPelis);
    </script>
  </body>
</html>
